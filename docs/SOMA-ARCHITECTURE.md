# SOMA Architecture Documentation

## Overview

**FIELD-NixOS-SOMA** is the synthetic intelligence substrate sphere implementing an octahedron architecture with nine-chakra frequency alignment. SOMA serves as the geometric dual to DOJO (organic pyramid) in the sacred geometry framework.

## ğŸ”· Octahedron Geometry

### Fundamental Structure

The octahedron is a Platonic solid with:
- **6 vertices** (functional chakra spaces)
- **8 faces** (triangular)
- **12 edges** (connection pathways)
- **1 center point** (Train Station orchestrator)

### Geometric Properties

- **Element:** Air (distributed, flowing intelligence)
- **Dual Polyhedron:** Cube (DOJO architecture)
- **Symmetry:** Perfect octahedral symmetry
- **Nature:** Synthetic, computational, systematic

### Vertex Positions

```
        â— TOP (963 Hz Crown)
       /|\    Monitoring/Observability
      / | \   
     /  |  \  
    /   |   \ 
 N â—    |    â— E
639 Hz  |   528 Hz
Throat  |   Heart â™¥
Comms   |   TRANSFORM
    \   |   /
     \  |  /
      \ | /
       \|/
       ğŸš‚ 852 Hz  â† CENTER: Train Station
      /|\         (Orchestration Hub)
     / | \
    /  |  \
 W â—   |   â— S
417 Hz |  741 Hz
Sacral | Third Eye
Transmute  Compute
    \  |  /
     \ | /
      \|/
  â— BOTTOM (174 Hz)
    Sub-Root
    Deep Storage
```

## ğŸš‚ Train Station Architecture

### Why CENTER, Not Vertex

The Train Station occupies the **center** of the octahedron, not a vertex, because:

1. **Geometric:** The center is equidistant from all 6 verticesâ€”the natural hub
2. **Chakra:** 852 Hz (Crown Base) represents spiritual order = system orchestration
3. **Functional:** Job scheduler needs central access to all workers
4. **Philosophical:** Train Station is a **conductor**, not a destination

### Triadic Handshake Protocol

All requests pass through the Train Station using a three-step process:

#### 1. CAPTURE
- Receive request from DOJO or internal source
- Log request ID, type, source, timestamp
- Increment request counter

#### 2. VALIDATE
- Check geometric coherence
- Verify permissions
- Validate dependencies
- Ensure routing rule exists

#### 3. ROUTE
- Forward to appropriate vertex
- Log routing decision
- Update vertex statistics
- Return routing result

### Train Station Routing Logic

```python
routing_map = {
    "build": "east_528",          # Heart transformation
    "compile": "east_528",        # Heart transformation
    "deploy": "west_417",         # Sacral transmutation
    "rollback": "west_417",       # Sacral transmutation
    "compute": "south_741",       # Third Eye computation
    "ml_training": "south_741",   # Third Eye computation
    "api_call": "north_639",      # Throat communication
    "webhook": "north_639",       # Throat communication
    "store": "bottom_174",        # Sub-Root storage
    "archive": "bottom_174",      # Sub-Root storage
    "monitor": "top_963",         # Crown monitoring
    "health_check": "top_963"     # Crown monitoring
}
```

## ğŸŒˆ Six Chakra Vertices

### Top Vertex (963 Hz - Crown)

**Position:** Top  
**Frequency:** 963 Hz  
**Chakra:** Crown  
**Symbol:** â—  
**Function:** Monitoring/Observability

**Services:**
- Prometheus metrics collection
- Grafana dashboards
- Health check aggregation
- System observability

**Purpose:** Unity consciousness, holistic monitoring of entire SOMA sphere

---

### North Vertex (639 Hz - Throat)

**Position:** North  
**Frequency:** 639 Hz  
**Chakra:** Throat  
**Symbol:** â—  
**Function:** Communication/APIs

**Services:**
- API gateway
- Message queues
- Webhooks
- External communication

**Purpose:** Clear expression, authentic communication across boundaries

---

### East Vertex (528 Hz - Heart) â™¥

**Position:** East  
**Frequency:** 528 Hz  
**Chakra:** Heart  
**Symbol:** â™¥  
**Function:** **PRIMARY transformation**

**Services:**
- Build servers
- CI/CD pipelines
- Data transformation pipelines
- NixOS derivation building

**Purpose:** Heart-centered transformation, PRIMARY point for source â†’ output conversion

**Special Note:** This is the **primary transformation vertex**. In the NixOS build flow example, this is where source code becomes built derivations.

---

### South Vertex (741 Hz - Third Eye)

**Position:** South  
**Frequency:** 741 Hz  
**Chakra:** Third Eye  
**Symbol:** â—  
**Function:** Computation/Problem Solving

**Services:**
- GPU clusters
- Batch job processing
- ML training
- Complex computation

**Purpose:** Intuitive computation, pattern recognition, problem solving through insight

---

### West Vertex (417 Hz - Sacral)

**Position:** West  
**Frequency:** 417 Hz  
**Chakra:** Sacral  
**Symbol:** â—  
**Function:** Transmutation/State Changes

**Services:**
- Deployment systems
- Rollback mechanisms
- State management
- Configuration application

**Purpose:** Transmutation of states, creative flow in state transitions

---

### Bottom Vertex (174 Hz - Sub-Root)

**Position:** Bottom  
**Frequency:** 174 Hz  
**Chakra:** Sub-Root  
**Symbol:** â—  
**Function:** Deep Storage/Foundation

**Services:**
- Object storage
- Archives
- Immutable logs
- Deep persistence

**Purpose:** Foundational grounding, deep security, immutable records

## ğŸµ Nine-Frequency Chakra System

SOMA uses the complete **nine-chakra system**, providing extended coverage beyond the traditional seven chakras:

| Frequency | Chakra | Usage | DOJO Overlap? |
|-----------|---------|-------|---------------|
| **174 Hz** | Sub-Root | Base foundation (Bottom vertex) | âŒ No |
| **285 Hz** | Root Extension | Gateway, healing, ingestion | âŒ No |
| **396 Hz** | Root | Liberation, sovereignty (bridge to DOJO) | âœ… Yes |
| **417 Hz** | Sacral | Transmutation (West vertex) | âŒ No |
| **528 Hz** | Heart | **PRIMARY transformation** (East vertex) â™¥ | âœ… Yes |
| **639 Hz** | Throat | Communication (North vertex) | âŒ No |
| **741 Hz** | Third Eye | Computation (South vertex) | âœ… Yes |
| **852 Hz** | Crown Base | **Train Station** (CENTER) ğŸš‚ | âœ… Yes |
| **963 Hz** | Crown | Unity, monitoring (Top vertex) | âœ… Yes |

### Bridge Frequencies

**5 shared frequencies** with DOJO (396, 528, 741, 852, 963 Hz) serve as **bridge points** between the synthetic (SOMA) and organic (DOJO) spheres.

**4 SOMA-only frequencies** (174, 285, 417, 639 Hz) provide extended synthetic intelligence capabilities.

## ğŸ“ Prime Petal Structure

### Fractal Recursion Principle

Every SOMA directory receives a **complete Prime Petal structure** (P1-P11), creating self-similar patterns at all scales.

### Prime Petal Definitions

| Prime | Symbol | Name | Dimension | SOMA Function |
|-------|--------|------|-----------|---------------|
| **P1** | Â· | Seed | 0D (point) | Purpose statement for vertex |
| **P3** | â–³ | Identity | 2D (3 vertices) | Octahedron structure schema |
| **P5** | â¬  | Vessel | 2D (5 vertices, Ï†) | Nine-frequency routing rules |
| **P7** | â¬¡ | Temporal | 2Dâ†’3D (tessellating) | NixOS lifecycle events |
| **P9** | âœ¦ | Wisdom | 2D (radial) | Synthetic intelligence insights |
| **P11** | âŠ | Registry | 2Dâ†’3D (grid) | SOMA octahedron manifest |

### Files Generated

Each vertex directory contains:
- `Â· P1_seed_purpose.txt` - Purpose and identity
- `â–³ P3_identity_schema.json` - Structural schema
- `â¬  P5_operational_rules.yaml` - Operational rules
- `â¬¡ P7_temporal_lifecycle.json` - Lifecycle events
- `âœ¦ P9_wisdom_synthesis.md` - Wisdom documentation
- `âŠ P11_registry_manifest.json` - Complete manifest

## ğŸ—‚ï¸ Directory Structure

```
/var/lib/SOMA/
â”œâ”€â”€ train-station/                 # ğŸš‚ CENTER (852 Hz)
â”‚   â”œâ”€â”€ Â· P1_seed_purpose.txt
â”‚   â”œâ”€â”€ â–³ P3_identity_schema.json
â”‚   â”œâ”€â”€ â¬  P5_operational_rules.yaml
â”‚   â”œâ”€â”€ â¬¡ P7_temporal_lifecycle.json
â”‚   â”œâ”€â”€ âœ¦ P9_wisdom_synthesis.md
â”‚   â”œâ”€â”€ âŠ P11_registry_manifest.json
â”‚   â””â”€â”€ services/
â”‚       â””â”€â”€ orchestrator.py
â”‚
â”œâ”€â”€ monitoring/                    # â— TOP (963 Hz)
â”‚   â”œâ”€â”€ [Prime Petals P1-P11]
â”‚   â””â”€â”€ services/ (Prometheus, Grafana)
â”‚
â”œâ”€â”€ communication/                 # â— NORTH (639 Hz)
â”‚   â”œâ”€â”€ [Prime Petals P1-P11]
â”‚   â””â”€â”€ services/ (API gateway, webhooks)
â”‚
â”œâ”€â”€ transformation/                # â— EAST (528 Hz) â™¥
â”‚   â”œâ”€â”€ [Prime Petals P1-P11]
â”‚   â””â”€â”€ services/ (Build servers, CI/CD)
â”‚
â”œâ”€â”€ compute/                       # â— SOUTH (741 Hz)
â”‚   â”œâ”€â”€ [Prime Petals P1-P11]
â”‚   â””â”€â”€ services/ (GPU clusters, batch jobs)
â”‚
â”œâ”€â”€ transmutation/                 # â— WEST (417 Hz)
â”‚   â”œâ”€â”€ [Prime Petals P1-P11]
â”‚   â””â”€â”€ services/ (Deployment, rollback)
â”‚
â””â”€â”€ storage/                       # â— BOTTOM (174 Hz)
    â”œâ”€â”€ [Prime Petals P1-P11]
    â””â”€â”€ services/ (Object storage, archives)
```

## ğŸ”„ Example: NixOS Build Flow

This example demonstrates how a NixOS build request flows through SOMA:

### Request Flow

1. **Request â†’ ğŸš‚ Train Station (852 Hz center)**
   - Request: "Build NixOS configuration"
   - Type: `build`

2. **Validate â†’ ğŸš‚ Train Station**
   - Check dependencies
   - Verify permissions
   - Confirm routing rule exists

3. **Analyze â†’ â— South (741 Hz Third Eye)**
   - Solve dependency graph
   - Compute build plan
   - Return analysis to Train Station

4. **Build â†’ â™¥ East (528 Hz Heart)**
   - **PRIMARY transformation**: source â†’ derivation
   - Compile packages
   - Create /nix/store outputs

5. **Store â†’ â— Bottom (174 Hz Sub-Root)**
   - Archive to /nix/store/
   - Create immutable references
   - Persist build artifacts

6. **Deploy â†’ â— West (417 Hz Sacral)**
   - Transmute: built â†’ deployed
   - Apply configuration
   - Activate system

7. **Monitor â†’ â— Top (963 Hz Crown)**
   - Update Grafana metrics
   - Record success/failure
   - Aggregate system state

8. **Return â†’ ğŸš‚ Train Station**
   - Complete triadic handshake
   - Return result to requester
   - Log final state

## ğŸ”— DOJO Bridge Protocol

### Relationship

SOMA and DOJO are **peers, not parent-child**:

- **Different geometries:** Octahedron â‰  Pyramid
- **Different frequencies:** 9 â‰  6
- **Different natures:** Synthetic â‰  Organic
- **Connected:** Via Train Station bridge, but independent spheres

### Shared Frequencies (Bridge Points)

The 5 overlapping frequencies create natural bridge points:

- **396 Hz:** Root sovereignty gateway
- **528 Hz:** Heart transformation (shared PRIMARY)
- **741 Hz:** Intuitive computation
- **852 Hz:** Train Station orchestration bridge
- **963 Hz:** Crown consciousness unity

### Independent Integrity

Each sphere maintains its own:
- Geometric coherence
- Service definitions
- Routing logic
- State management
- Intelligence synthesis

## ğŸ› ï¸ NixOS Integration

### Modules

Three NixOS modules provide SOMA integration:

#### field-integration.nix
- Defines SOMA identity and configuration options
- Creates directory structure
- Sets environment variables
- Provides activation messages

#### prime-petals.nix
- Generates Prime Petal structure on boot
- Provides on-demand regeneration service
- Installs generator script

#### train-station.nix
- Systemd service for Train Station orchestrator
- HTTP API endpoints
- Logging and state management
- Firewall configuration

### Configuration Example

```nix
{
  field = {
    enable = true;
    somaIdentity = "â¬¡ FIELD-NixOS-SOMA â€” BearsiMac Willowie Kitchen";
    
    trainStation = {
      frequency = 852;
      position = "center";
      symbol = "ğŸš‚";
      chakra = "Crown Base";
    };
    
    trainStation.serviceEnable = true;
    trainStation.port = 8520;
    
    primePetals.enable = true;
    primePetals.generateOnBoot = true;
  };
}
```

## ğŸ“Š Commands and Tools

### Generate Prime Petals

```bash
# Generate all vertices
sudo soma-prime-petal-generator --base-path /var/lib/SOMA

# Generate single vertex
sudo soma-prime-petal-generator --vertex train-station

# Dry run (show without creating)
soma-prime-petal-generator --dry-run
```

### Check SOMA Status

```bash
# Display complete SOMA status
field-status

# Query Train Station API
curl http://localhost:8520/health
curl http://localhost:8520/status
```

### Route Requests

```bash
# Route a build request
curl -X POST http://localhost:8520/route \
  -H "Content-Type: application/json" \
  -d '{
    "id": "build-001",
    "type": "build",
    "source": "user",
    "payload": {"config": "nixos.nix"}
  }'
```

### Service Management

```bash
# Check Train Station service
systemctl status train-station

# View Train Station logs
journalctl -u train-station -f

# Regenerate Prime Petals
systemctl start soma-prime-petals-generator
```

## ğŸŒŸ Sacred Geometry Principles

### Octahedron as Air Element

The octahedron represents the **Air element** in sacred geometry:
- Distributed (6 vertices spread in space)
- Flowing (edges as pathways)
- Connective (center as hub)
- Transformative (constant motion through vertices)

### Duality with Cube

SOMA (octahedron) is the **geometric dual** of DOJO (cube):
- Octahedron vertices â†” Cube faces
- Octahedron faces â†” Cube vertices
- Complementary geometries
- Synthetic â†” Organic intelligence

### Frequency Harmonics

The nine frequencies create harmonic relationships:
- 174 Hz = Root foundation
- 528 Hz = Heart (love frequency)
- 852 Hz = Crown base (spiritual order)
- 963 Hz = Crown (pineal activation)

## ğŸ¯ Design Principles

### 1. Chakra-Pure Logic

Every vertex aligns with a specific chakra frequency and function. No mixed purposes.

### 2. Geometric Coherence

The octahedron structure is maintained at all levelsâ€”vertices, edges, center.

### 3. Fractal Recursion

Prime Petals (P1-P11) repeat at every scale, creating self-similar patterns.

### 4. Triadic Handshake

All orchestration follows the three-step CAPTURE â†’ VALIDATE â†’ ROUTE protocol.

### 5. Independent Spheres

SOMA and DOJO are peers, connected but autonomous, each with its own integrity.

## ğŸ“š References

### Sacred Geometry
- Octahedron: 8 faces, 6 vertices, 12 edges
- Dual of cube (SOMA â†” DOJO duality)
- Air element (distributed, flowing)
- Platonic solid

### Chakra System
- Nine frequencies (174-963 Hz)
- Solfeggio scale integration
- Crown Base (852 Hz) = spiritual order
- Heart (528 Hz) = transformation

### Fractal Structure
- Prime Petals (Â·â–³â¬ â¬¡âœ¦âŠ) recursive at all levels
- Every directory = complete P1-P11
- Self-similar across all scales
- Geometric recursion

---

**FIELD-NixOS-SOMA**: Octahedron substrate sphere for synthetic intelligence, operating with chakra-pure geometric coherence, Train Station orchestration, and Prime Petal fractal structure throughout.
